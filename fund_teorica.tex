\chapter{Fundamentação Teórica} \label{chap:fundteor}

Este capítulo apresenta a fundamentação teórica, ou seja, o estudo das técnicas e algoritmos utilizados durante o trabalho. O capitulo divide-se em três seções. 

A seção \ref{sec:segmentacao} apresenta técnicas e algoritmos que serão úteis para para realizar a segmentação de imagens. A segmentação de imagens consiste em subdividir a imagem original em regiões ou objetos até que se tenha identificado a região ou objeto de interesse.

A seção \ref{sec:descricao} apresenta técnicas e algoritmos para realizar a descrição de imagens. Após a segmentação de uma imagem é necessário representar a imagem para que se possa efetuar posteriores processamentos em cima dela. Existem duas abordagem para esse problema \cite{GONZALEZ-2006}: representação por meio de características externas da região, como bordas, ou representação por meio de características internas, como textura. A representação por características externas normalmente é utilizada quando se está interessado na forma da região. Já a representação por características internas é utilizada quando o foco está na cor ou textura da região. Nessa seção aborda-se principalmente características externas de imagens.

Finalmente a seção \ref{sec:classificacao} apresenta uma visão geral de reconhecimento de padrões utilizando redes neurais. O reconhecimento de padrões é feito tomando como base os descritores obtidos a partir de técnicas como as vistas na seção \ref{sec:descricao}.


\section{Segmentação} \label{sec:segmentacao}

Esta seção apresenta técnicas e algoritmos para realizar a segmentação de imagens, tais como técnicas de subtração de fundo, limiarização, operações morfológicas, esqueletonização e análise de componentes principais.


\subsection{Subtração de fundo} \label{sub:fundteor_sub_fundo}

Técnicas de subtração de fundo são amplamente empregadas para a detecção de movimento em sequencias de imagens de vídeo. A detecção do movimento se dá pela subtração da imagem de referencia chamada "fundo", ou em inglês \emph{background image}, da imagem a ser segmentada. A imagem de fundo não deve possuir objetos em movimento e deve estar sempre atualizada com relação à variações de iluminação \cite{BACKGROUND-SUBTRACTION}.

O método mais simples de subtração de fundo consiste em subtrair a imagem de fundo da imagem a ser segmentada e em seguida aplicar  um limiar no resultado. Pode-se resumir esse método na equação \ref{eq:fundteor_background_sub}. Onde, $D(t+1)$ é a imagem segmentada, $V(x,y,t+1)$ é a imagem de entrada, $V(x,y,t)$ é a imagem de referencia, ou fundo e $Th$ é um limiar, que pode ser escolhido conforme os métodos apresentados na seção \ref{sub:fundteor_limiarizacao}.

\begin{equation}
D(t+1) = \left |V(x,y,t+1)-V(x,y,t)  \right |> Th
\label{eq:fundteor_background_sub}
\end{equation}

Existem outros métodos mais complexos, como \emph{Running Gaussian average}, \emph{Temporal median filter}, entre outros, que geram melhores resultados com fundos que não são completamente estáticos \cite{BACKGROUND-SUBTRACTION}, porém não são de interesse para este projeto.


\subsection{Limiarização} \label{sub:fundteor_limiarizacao}

Pela simplicidade na implementação e pela baixa complexidade computacional os algoritmos de limiarização são amplamente utilizados na segmentação de imagens. Os métodos de limiarização consistem na partição da imagem baseado na intensidade dos pixeis. Caso a partição seja feita com base em um único limiar de intensidade a limiarização se diz global. Caso a partição seja feita levando em conta os valores de intensidade dos pixeis em uma região de vizinhança de um certo pixel, então o método é chamado de limiarização local \cite{GONZALEZ-2006}. A equação \ref{eq:fundteor_thresholding} descreve esse processo, $g(x,y)$ é a imagem limiarizada, $f(x,y)$ é a imagem de entrada e $T$ é um limiar, que pode variar para diferentes valores de $x$ e $y$ caso a limiarização seja local.

\begin{equation}
g(x,y) =\left\{\begin{matrix}
1\;\;\;\; if \; f(x,y) > T\\ 
0\;\;\;\; if \; f(x,y) \leq T
\end{matrix}\right.
\label{eq:fundteor_thresholding}
\end{equation}

Na figura \ref{fig:fundteor_fig_limiarizacao} mostra-se duas imagens e seus respectivos histogramas. A figura \ref{fig:fundteor_hist_sem_ruido} mostra o histograma para uma imagem sem ruído e a figura \ref{fig:fundteor_hist_com_ruido} mostra o histograma para uma imagem com ruido gaussiano. Como pode-se ver na figura \ref{fig:fundteor_hist_sem_ruido} a escolha de um valor para limiar $T$ é uma tarefa fácil, porém para a imagem da figura \ref{fig:fundteor_hist_com_ruido} a escolha do limiar $T$ não é mais trivial. A seguir descreve-se um métodos para obtenção de limiar para limiarização global que pode ser aplicado nos dois casos vistos. 

\begin{figure}[H]
        \centering
	\begin{subfigure}[b]{0.4\textwidth}
                \includegraphics[width=\textwidth]{./figs/thresholding_sem_ruido.png}
                \caption{Imagem sem ruido}
                \label{fig:fundteor_sem_ruido}
		\fonte{\cite{MATHWORKS-HELP}}
        \end{subfigure}
       ~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
        \begin{subfigure}[b]{0.4\textwidth}
                \includegraphics[width=\textwidth]{./figs/thresholding_ruido.png}
                \caption{Imagem com ruido}
                \label{fig:fundteor_com_ruido}
		\fonte{Autoria própria}
        \end{subfigure}
        %add desired spacing between images, e. g. ~, \quad, \qquad etc.
        %(or a blank line to force the subfigure onto a new line)
        
	\begin{subfigure}[b]{0.4\textwidth}
                \includegraphics[width=\textwidth]{./figs/thresholding_histograma_sem_ruido.png}
                \caption{Histograma da imagem sem ruido}
                \label{fig:fundteor_hist_sem_ruido}
		\fonte{Autoria própria}
        \end{subfigure}
       ~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
        \begin{subfigure}[b]{0.4\textwidth}
                \includegraphics[width=\textwidth]{./figs/thresholding_histograma_ruido.png}
                \caption{Histograma da imagem com ruido}
                \label{fig:fundteor_hist_com_ruido}
		\fonte{Autoria própria}
        \end{subfigure}
        %add desired spacing between images, e. g. ~, \quad, \qquad etc.
        %(or a blank line to force the subfigure onto a new line)

        \caption{Imagens com e sem ruído e seus respectivos histogramas}
	\label{fig:fundteor_fig_limiarizacao}
\end{figure}

%\subsubsection{Limiarização global}
	% basic global thresholding

\subsubsection{Limiarização global pelo método de \emph{Otsu}}
	% metodo de otsu
O método para determinar o valor do limiar $T$ proposto por \emph{Otsu} é um método ótimo que busca maximizar a variância entre as duas classes. Isso baseia-se no fato de que classes bem divididas possuem valores de intensidades distintos, e o valor ótimo para $T$ é o valor tal que haja maior separação entre as intensidades \cite{GONZALEZ-2006}.

O cálculo do valor limiar pelo método de \emph{Otsu} se dá pela equação \ref{eq:fundteor_otsu}.

\begin{equation}
\sigma _{B}^{2} (t) = \frac{\left [m_{G}P_{1}(t) - m(t)  \right ]^{2}}{P_{1}(t)\left [ 1 - P_{1}(t) \right ]}
\label{eq:fundteor_otsu}
\end{equation}

Onde:

\begin{itemize}
\item $\sigma _{B}^{2} (t)$ é a variância entre as classes para um valor limiar t;
\item $m_{G}$ é a média global de intensidades da imagem;
\item $ m(t)$ é a média acumulada das intensidades de $t=0$ até a intensidade $t$;
\item $P_{1}(t)$ é a probabilidade de um pixel qualquer da imagem estar na classe 1 dado o valor limiar $t$.
\end{itemize}

Portanto, para o cálculo do valor limiar pelo método de \emph{Otsu} basta encontrar o valor limiar $t$ tal que $\sigma _{B}^{2} (t)$ é máximo. A dedução da equação \ref{eq:fundteor_otsu} está fora do escopo deste projeto, mas pode ser encontrada em \cite{GONZALEZ-2006}. 

Na figura \ref{fig:fundteor_fig_limiarizada} mostram-se as imagens da figura \ref{fig:fundteor_fig_limiarizacao} limiarizadas pelo método de \emph{Otsu} e seus respectivos valores de limiarização.

\begin{figure}[H]
        \centering
	\begin{subfigure}[b]{0.4\textwidth}
                \includegraphics[width=\textwidth]{./figs/thresholded_sem_ruido.png}
                \caption{Imagem sem ruido limiarizada}
                \label{fig:fundteor_t_sem_ruido}
        \end{subfigure}
       ~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
        \begin{subfigure}[b]{0.4\textwidth}
                \includegraphics[width=\textwidth]{./figs/thresholded_ruido.png}
                \caption{Imagem com ruido limiarizada}
                \label{fig:fundteor_t_com_ruido}
        \end{subfigure}
        %add desired spacing between images, e. g. ~, \quad, \qquad etc.
        %(or a blank line to force the subfigure onto a new line)
        
	\begin{subfigure}[b]{0.4\textwidth}
                \includegraphics[width=\textwidth]{./figs/thresholded_histograma_sem_ruido.png}
                \caption{Histograma da imagem sem ruido com o valor do limiar T}
                \label{fig:fundteor_t_hist_sem_ruido}
        \end{subfigure}
       ~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
        \begin{subfigure}[b]{0.4\textwidth}
                \includegraphics[width=\textwidth]{./figs/thresholded_histograma_ruido.png}
                \caption{Histograma da imagem com ruido com o valor do limiar T}
                \label{fig:fundteor_t_hist_com_ruido}
        \end{subfigure}
        %add desired spacing between images, e. g. ~, \quad, \qquad etc.
        %(or a blank line to force the subfigure onto a new line)

        \caption{Imagens limiarizadas pelo método de \emph{Otsu} e seus respectivos histogramas}
	\fonte{Autoria própria}
	\label{fig:fundteor_fig_limiarizada}
\end{figure}


\subsection{Operações morfológicas básicas} \label{sub:fundteor_op_morfologicas}

Operações morfológicas como abertura e fechamento podem ser úteis para filtrar imagens. Principalmente para filtrar imagens binárias onde a operação de fechamento pode ser aplicada para diminuir ruido.

Para o estudo das operações morfológicas de abertura e fechamento precisa-se primeiramente esclarecer alguns pontos:

\begin{itemize}
\item Podemos representar imagens binárias como sendo um conjunto de pixeis no espaço $Z^2$, onde cada pixel é representado por uma tupla $(x,y)$ e $x$ e $y$ são as coordenadas do pixel.
\item A translação de um conjunto $B$ para um ponto $z = (z_{1},z_{2})$, denotado por $(B)_z$ é o conjunto de pontos em $B$ com as respectivas coordenas $(x,y)$ tendo sido substituídas pela coordenadas $(x+z_{1}, y+z_{2})$.
\item Elemento estruturante é um conjunto de pixeis que é utilizado para fazer operações sobre uma imagem. Cada elemento estruturante possui um pixel de origem. A figura \ref{fig:fundteor_elementos_estruturantes} mostra exemplos de elementos estruturantes e suas respectivas origens.

\begin{figure}[H]
	\centering
	\includegraphics[width=0.8\textwidth]{./figs/elementos_estruturantes.png}
	\caption{Exemplos de elementos estruturantes.}
	\fonte{Autoria própria}
	\label{fig:fundteor_elementos_estruturantes}
\end{figure}

\item O elemento estruturante pode ser utilizado para fazer operações sobre uma imagem binária. Considere por exemplo a operação no conjunto $A$, feita pelo elemento estruturante $B$ (figuras \ref{fig:fundteor_elementos_estruturantes_ex_A} e \ref{fig:fundteor_elementos_estruturantes_ex_B}): Cria-se um novo conjunto $C$ sobrepondo $B$ em $A$ da maneira que a origem de $B$ passe por todos os pixeis de $A$. Em cada ponto que a origem de $B$ passa verifica-se se $B$ está completamente contido em $A$. Se estiver marca-se esse ponto no conjunto $C$. A figura \ref{fig:fundteor_elementos_estruturantes_ex_C} mostra o resultado da operação, ou seja, o conjunto $C$.

\begin{figure}[H]
        \centering
	\begin{subfigure}[b]{0.4\textwidth}
                \includegraphics[width=\textwidth]{./figs/elementos_estruturantes_A.png}
                \caption{Imagem binária $A$}
                \label{fig:fundteor_elementos_estruturantes_ex_A}
        \end{subfigure}
       ~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
        \begin{subfigure}[b]{0.4\textwidth}
                \includegraphics[width=\textwidth]{./figs/elementos_estruturantes_B.png}
                \caption{Elemento estruturante $B$}
                \label{fig:fundteor_elementos_estruturantes_ex_B}
        \end{subfigure}
        %add desired spacing between images, e. g. ~, \quad, \qquad etc.
        %(or a blank line to force the subfigure onto a new line)
        
	\begin{subfigure}[b]{0.4\textwidth}
                \includegraphics[width=\textwidth]{./figs/elementos_estruturantes_C.png}
                \caption{$C$, resultado da operação de $B$ em $A$}
                \label{fig:fundteor_elementos_estruturantes_ex_C}
        \end{subfigure}

        \caption{Imagem binária, elemento estruturante e operação de $B$ em $A$}
	\fonte{Autoria própria}
	\label{fig:elementos_estruturantes_ex}
\end{figure}

\end{itemize}

A seguir apresentam-se as operações de erosão e de dilatação, que são necessárias para as operações de abertura e fechamento que são apresentadas na sequencia.


\subsubsection{Erosão}

Sendo $A$ e $B$ conjuntos no espaço $Z^2$, a erosão do conjunto $A$ pelo elemento estruturante $B$, denotada por $A \ominus B$, é definida na equação \ref{eq:fundteor_erosao} \cite{GONZALEZ-2006}.

\begin{equation}
A \ominus B = \left \{ z \mid (B)_z \subseteq A) \right \}
\label{eq:fundteor_erosao}
\end{equation}

Ou seja, a erosão de $A$ por $B$ é o conjunto de todos os pontos $z$ tal que $B$, transladado por $z$, está contido em $A$.
Pode-se ver melhor esse processo na figura \ref{fig:fundteor_erosao_A_B}, onde o conjunto A é erodido pelo elemento estruturante B formando o conjunto $A \ominus B$.

\begin{figure}[H]
	\centering
	\includegraphics[width=0.8\textwidth]{./figs/erosao_A_B.png}
	\caption{Exemplo de erosão do conjunto A por B.}
	\fonte{\cite{GONZALEZ-2006}}
	\label{fig:fundteor_erosao_A_B}
\end{figure}
 

\subsubsection{Dilatação}

Sendo $A$ e $B$ conjuntos no espaço $Z^2$, a dilatação do conjunto $A$ pelo elemento estruturante $B$, denotada por $A \oplus  B$, é definida na equação \ref{eq:fundteor_dilatacao} \cite{GONZALEZ-2006}.

\begin{equation}
A \oplus B = \left \{ z\mid \left [(\hat{B})_{z} \cap A  \right ] \subseteq A \right \}
\label{eq:fundteor_dilatacao}
\end{equation}

Onde $\hat{B}$ é o conjunto $B$ espelhado. Quando o elemento estruturante é simétrico então $\hat{B}=B$. 

A equação \ref{eq:fundteor_dilatacao} diz que a dilatação do conjunto $A$ pelo elemento estruturante $B$ é o conjunto de todos os pontos $z$ tal que se $\hat{B}$ e $A$ se sobrepõem em pelo menos um ponto, então $z$ faz parte de $A \oplus B$. Pode-se ver melhor esse processo na figura \ref{fig:fundteor_dilatacao_A_B}, onde o conjunto $A$ é dilatado pelo elemento estruturante $B$ formando o conjunto $A \oplus B$.

\begin{figure}[H]
	\centering
	\includegraphics[width=0.8\textwidth]{./figs/dilatacao_A_B.png}
	\caption{Exemplo de dilatação do conjunto A por B.}
	\fonte{\cite{GONZALEZ-2006}}
	\label{fig:fundteor_dilatacao_A_B}
\end{figure}


\subsubsection{Abertura e Fechamento}

A abertura do conjunto $A$ pelo elemento estruturante $B$ é definida pela equação \ref{eq:fundteor_abertura}  \cite{GONZALEZ-2006}.

\begin{equation}
A \circ B = \left ( A \ominus B \right ) \oplus B
\label{eq:fundteor_abertura}
\end{equation}

E o fechamento do conjunto $A$ pelo elemento estruturante $B$ é definido pela equação \ref{eq:fundteor_fechamento}  \cite{GONZALEZ-2006}.

\begin{equation}
A \bullet B = \left ( A \oplus B \right ) \ominus B
\label{eq:fundteor_fechamento}
\end{equation}

Na figura \ref{fig:regiao_abertura} pode-se ver o resultado da execução da operação de abertura em cima do conjunto $A$ da figura \ref{fig:regiao_teste_A}. Em seguida na figura \ref{fig:regiao_fechamento} pode-se ver o resultado da execução da operação de fechamento em cima do mesmo conjunto da figura \ref{fig:regiao_teste_A}. Como pode-se ver, a operação de abertura "abre" a imagem em pontos estreitos, já a operação de fechamento "fecha" a imagem onde existem concavidades pequenas.

\begin{figure}[H]
	\centering
	\includegraphics[width=0.5\textwidth]{./figs/regiao_teste.png}
	\caption{Conjunto $A$.}
	\fonte{\cite{GONZALEZ-2006}}
	\label{fig:regiao_teste_A}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width=0.8\textwidth]{./figs/regiao_abertura.png}
	\caption{Conjunto $A \circ B$.}
	\fonte{\cite{GONZALEZ-2006}}
	\label{fig:regiao_abertura}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width=0.8\textwidth]{./figs/regiao_fechamento.png}
	\caption{Conjunto $A \bullet B$.}
	\fonte{\cite{GONZALEZ-2006}}
	\label{fig:regiao_fechamento}
\end{figure}


\subsection{Esqueletonização}

Sendo $S(A)$ o esqueleto de $A$ e $(D)_{z}$ o maior disco centrado em $z$ e contido em $A$, pode se dizer que \cite{GONZALEZ-2006}:

\begin{itemize}
\item Se $z$ faz parte de $S(A)$ então não é possível encontrar um disco maior que $(D)_{z}$, não necessariamente centrado em $z$, que contenha $(D)_{z}$ e que esteja completamente incluso em $A$;
\item O disco $(D)_{z}$ toca a borda de $A$ em pelo menos dois pontos distintos.
\end{itemize}

Isso pode ser visto melhor na figura \ref{fig:esqueletonizacao_exemplo}.

\begin{figure}[H]
	\centering
	\includegraphics[width=0.8\textwidth]{./figs/esqueletonizacao_exemplo.png}
	\caption{Conjunto $A$, disco máximo centrado em diversos pontos $z$ e esqueleto completo.}
	\fonte{\cite{GONZALEZ-2006}}
	\label{fig:esqueletonizacao_exemplo}
\end{figure}

Pode-se definir também o esqueleto $S(A)$ em função de erosões e aberturas sucessivas como mostrado nas equações \ref{eq:fundteor_esqueletonizacao_1}, \ref{eq:fundteor_esqueletonizacao_2}, \ref{eq:fundteor_esqueletonizacao_3} e \ref{eq:fundteor_esqueletonizacao_4} \cite{GONZALEZ-2006}.

\begin{equation}
S(A) = \bigcup_{k = 0}^{K} S_{k}(A)
\label{eq:fundteor_esqueletonizacao_1}
\end{equation}

Com:

\begin{equation}
S_{k}(A) = (A \ominus k B) - (A \ominus k B) \circ B
\label{eq:fundteor_esqueletonizacao_2}
\end{equation}

Onde $B$ é um elemento estruturante e $(A \ominus k B)$ indica $k$ sucessivas erosões de $A$:

\begin{equation}
(A \ominus k B) = ((...((A \ominus B) \ominus B) \ominus ...) \ominus B)
\label{eq:fundteor_esqueletonizacao_3}
\end{equation}

Sendo K o ultimo passo antes de $A$ erodir para um conjunto vazio. Ou seja:

\begin{equation}
K = max \left \{ k \mid (A \ominus k B) \neq \varnothing  \right \}
\label{eq:fundteor_esqueletonizacao_4}
\end{equation}


\subsubsection {Poda (\emph{Pruning})}

Aplicando-se o método de esqueletonização mencionado anteriormente em figuras reais, como a figura \ref{fig:fundteor_sketon_in}, pode-se obter resultados como a figura \ref{fig:fundteor_sketon_out}. Devido a esse tipo de resultados aplica-se após a esqueletonização um método de poda. A poda do esqueleto consiste em avaliar o tamanho dos ramos gerados, caso sejam menores que um valor limiar, são removidos. A figura \ref{fig:fundteor_sketon_out_20} mostra o método de poda aplicado com um limiar de 20 pixeis.

\begin{figure}[H]
        \centering
	\begin{subfigure}[b]{0.49\textwidth}
                \includegraphics[width=\textwidth]{./figs/skeleton_in.png}
                \caption{Imagem de entrada}
                \label{fig:fundteor_sketon_in}
        \end{subfigure}

       ~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
        \begin{subfigure}[b]{0.49\textwidth}
               \includegraphics[width=\textwidth]{./figs/skeleton_out.png}
                \caption{Imagem esqueletonizada}
                \label{fig:fundteor_sketon_out}
        \end{subfigure}
        %add desired spacing between images, e. g. ~, \quad, \qquad etc.
        %(or a blank line to force the subfigure onto a new line)
	\begin{subfigure}[b]{0.49\textwidth}
                \includegraphics[width=\textwidth]{./figs/skeleton_out_20.png}
                \caption{Imagem esqueletonizada e podada}
                \label{fig:fundteor_sketon_out_20}
        \end{subfigure}

        \caption{Exemplo de esqueletonização e poda.}
	\fonte{Autoria própria}
	\label{fig:fundteor_sketon}
\end{figure}


\subsection{Normalização}

A análise de componentes principais pode ser empregada para normalizar imagens em função de rotação, translação e tamanho  \cite{GONZALEZ-2006}. Explica-se a seguir alguns conceitos necessários para efetuar a normalização utilizando a analise de componentes principais e em seguida o processo de normalização utilizando componentes principais.

\subsubsection{Matriz de covariâncias}

Considere as imagens da figura \ref{fig:fundteor_pca}. Os pontos da imagem, podem ser considerados como sendo vetores $x=(x_{1},x_{2})^{T}$, onde $x_{1}$ e $x_{2}$ são as coordenadas do ponto $x$, e $T$ indica a matriz transposta. Os pontos $x$ portanto formam uma população de vetores no espaço $Z^{2}$. Sendo assim pode-se calcular a matriz de covariâncias $C_{x}$ e o vetor da média $m_{x}$ para a população de vetores.

Para $K$ amostras de uma população aleatória pode-se aproximar a média $m_{x}$ pela equação \ref{eq:fundteor_mean} \cite{GONZALEZ-2006}.

\begin{equation}
m_{x} = \frac{1}{K} \sum_{k=1}^{K} x_{k}
\label{eq:fundteor_mean}
\end{equation}

Agora utilizando a média $m_{x}$, pode-se aproximar a matriz de covariâncias $C_{x}$ pela equação \ref{eq:fundteor_cov} \cite{GONZALEZ-2006}.

\begin{equation}
C_{x} = \frac{1}{K} \sum_{k=1}^{K} x_{k} x_{k}^{T} - m_{x}m_{x}^{T}
\label{eq:fundteor_cov}
\end{equation}

Na matriz de covariâncias os elementos $c_{ii}$ de $C_{x}$ representam a variância entre os valores na coordenada $x_{i}$. Os elementos $c_{ij}$ representam a covariância entre os valores na coordenada $x_{i}$ com os valores da coordenada $x_{j}$. Portanto, a matriz de covariância possui informações que dizem respeito à distribuição dos pixeis da imagem. 

Pode-se ver isso melhor nas matrizes de covariância apresentadas nas figuras \ref{fig:fundteor_pca_xc}, \ref{fig:fundteor_pca_yc} e \ref{fig:fundteor_pca_xyc} que foram calculadas para as imagens das figuras \ref{fig:fundteor_pca_x}, \ref{fig:fundteor_pca_y} e \ref{fig:fundteor_pca_xy} respectivamente. Percebe-se que na figura \ref{fig:fundteor_pca_xc} a maior variância ocorre entre os elementos da coordenada $x_{1}$, visto que $c_{11}$ possui o maior valor na matriz de covariâncias. Semelhantemente percebe-se que na figura \ref{fig:fundteor_pca_yc} a maior variância ocorre entre os elementos da coordenada $x_2$. A terceira imagem, figura \ref{fig:fundteor_pca_xyc}, mostra uma distribuição mais continua em $x_{1}$ e $x_{2}$, mas valores maiores para as covariâncias entre os elementos das coordenadas $x_{1}$ e $x_{2}$. A terceira imagem mostra portanto o relacionamento entre as duas coordenadas da imagem: quando  $x_{1}$ aumenta,  $x_{2}$ tende a aumentar também, e vice-versa.

\begin{figure}[H]
        \centering
	\begin{subfigure}[b]{0.3\textwidth}
                \includegraphics[width=\textwidth]{./figs/pca_x.png}
	        \caption{}
                \label{fig:fundteor_pca_x}
        \end{subfigure}
       ~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
        \begin{subfigure}[b]{0.3\textwidth}
                \includegraphics[width=\textwidth]{./figs/pca_y.png}
	        \caption{}
                \label{fig:fundteor_pca_y}
        \end{subfigure}
       ~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
	\begin{subfigure}[b]{0.3\textwidth}
                \includegraphics[width=\textwidth]{./figs/pca_xy.png}
	        \caption{}
                \label{fig:fundteor_pca_xy}
        \end{subfigure}

	\begin{subfigure}[b]{0.3\textwidth}
		\centerline{$\begin{bmatrix}
			457 & -13.6 \\ 
			-13.6 & 35.0
		\end{bmatrix}$}
	        \caption{}
                \label{fig:fundteor_pca_xc}
        \end{subfigure}
       ~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
        \begin{subfigure}[b]{0.3\textwidth}
		\centerline{$\begin{bmatrix}
			39.1 & -8.30 \\ 
			-8.30 & 263
		\end{bmatrix}$}
	        \caption{}
                \label{fig:fundteor_pca_yc}
        \end{subfigure}
       ~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
	\begin{subfigure}[b]{0.3\textwidth}
		\centerline{$\begin{bmatrix}
			360 & -318 \\ 
			-318 & 343
		\end{bmatrix}$}
	        \caption{}
                \label{fig:fundteor_pca_xyc}
        \end{subfigure}

        \caption{Imagens de exemplo e suas respectivas matrizes de covariância.}
	\fonte{Autoria própria}
	\label{fig:fundteor_pca}
\end{figure}

\subsubsection{Autovetores e autovalores}

Um autovetor de uma matriz $A$ é um vetor não nulo $v$, que quando a matriz é multiplicada por $v$ tem-se um vetor que é múltiplo de $v$ por uma constante $\lambda$ denominada autovalor. Ou seja, a equação \ref{eq:fundteor_eigen} é verdadeira \cite{AUTOVETORES}.

\begin{equation}
Av = \lambda v
\label{eq:fundteor_eigen}
\end{equation}

Algumas propriedades de autovetores:

\begin{itemize}
\item Os autovetores podem ser calculados apenas para matrizes quadradas \cite{AUTOVETORES};
\item Para uma matriz $nxn$ existem $n$ autovetores \cite{AUTOVETORES};
\item Todos os autovetores são ortogonais entre si \cite{GONZALEZ-2006}.
\end{itemize}

\subsubsection{Analise de componentes principais}

% http://www.cs.otago.ac.nz/cosc453/student_tutorials/principal_components.pdf
% https://inst.eecs.berkeley.edu/~ee127a/book/login/l_sym_pca.html
Pode-se demonstrar que o autovetor associado ao maior autovalor de uma matriz de covariâncias aponta na direção de maior variação dos dados \cite{AUTOVETORES-DEDUCAO}. Pode-se demonstrar também que o segundo autovetor, associado ao segundo maior autovalor, aponta na segunda direção de maior variação dos dados. A esses autovetores se dá o nome de componentes principais da imagem.

Considere por exemplo as imagens da figura \ref{fig:fundteor_pca2}. Calculamos os autovetores para cada uma das imagens tomando como base as matrizes de covariância apresentadas nas figuras \ref{fig:fundteor_pca_xc}, \ref{fig:fundteor_pca_yc} e \ref{fig:fundteor_pca_xyc}. Os autovetores podem ser vistos nas figuras \ref{fig:fundteor_pca_xam}, \ref{fig:fundteor_pca_yam} e \ref{fig:fundteor_pca_xyam}. O autovetor associado ao maior autovalor está na primeira linha de cada matriz e o seguindo autovetor está na segunda linha. Os autovetores foram representados sobre as respectivas imagens nas figuras \ref{fig:fundteor_pca_xa}, \ref{fig:fundteor_pca_ya} e \ref{fig:fundteor_pca_xya}.

\begin{figure}[H]
        \centering
	\begin{subfigure}[b]{0.3\textwidth}
                \includegraphics[width=\textwidth]{./figs/pca_xa.png}
	        \caption{}
                \label{fig:fundteor_pca_xa}
        \end{subfigure}
       ~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
        \begin{subfigure}[b]{0.3\textwidth}
                \includegraphics[width=\textwidth]{./figs/pca_ya.png}
	        \caption{}
                \label{fig:fundteor_pca_ya}
        \end{subfigure}
       ~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
	\begin{subfigure}[b]{0.3\textwidth}
                \includegraphics[width=\textwidth]{./figs/pca_xya.png}
	        \caption{}
                \label{fig:fundteor_pca_xya}
        \end{subfigure}

	\begin{subfigure}[b]{0.3\textwidth}
		\centerline{$\begin{bmatrix}
			0.999 & 0.0321 \\ 
			0.0321 & -0.999
		\end{bmatrix}$}
	        \caption{}
                \label{fig:fundteor_pca_xam}
        \end{subfigure}
       ~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
        \begin{subfigure}[b]{0.3\textwidth}
		\centerline{$\begin{bmatrix}
			0.0369 & 0.999 \\ 
			0.999 & -0.0369
		\end{bmatrix}$}
	        \caption{}
                \label{fig:fundteor_pca_yam}
        \end{subfigure}
       ~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
	\begin{subfigure}[b]{0.3\textwidth}
		\centerline{$\begin{bmatrix}
			0.716 & 0.698 \\ 
			0.698 & -0.716
		\end{bmatrix}$}
	        \caption{}
                \label{fig:fundteor_pca_xyam}
        \end{subfigure}

        \caption{Imagens de exemplo e seus respectivos autovetores.}
	\fonte{Autoria própria}
	\label{fig:fundteor_pca2}
\end{figure}

Vê-se portanto que se pode definir um eixo absoluto para cada imagem com base na distribuição dos pixeis sobre a imagem.

\subsubsection{Normalização}

A normalização das imagens pode ser feita por meio de uma matriz de transformação que mapeia valores do sistema de coordenadas original da imagem para o sistema de coordenadas formado pelos autovetores da imagem \cite{GONZALEZ-2006}. A transformação em questão podes ser expressa pela equação \ref{eq:fundteor_transf}.

\begin{equation}
y = A ( x - m_{x} )
\label{eq:fundteor_transf}
\end{equation}

Onde:

\begin{itemize}
\item $y$ é o valor no novo sistema de coordenadas formado pelos autovetores.
\item $x$ o valor da coordenada no sistema original.
\item $A$ a matriz de autovetores.
\item $m_{x}$ vetor da média.
\end{itemize}

As imagens da figura \ref{fig:fundteor_pca} podem ser vistas normalizadas na figura \ref{fig:fundteor_pca3}.

\begin{figure}[H]
        \centering
	\begin{subfigure}[b]{0.3\textwidth}
                \includegraphics[width=\textwidth]{./figs/pca_xn.png}
	        \caption{}
                \label{fig:fundteor_pca_xa}
        \end{subfigure}
       ~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
        \begin{subfigure}[b]{0.3\textwidth}
                \includegraphics[width=\textwidth]{./figs/pca_yn.png}
	        \caption{}
                \label{fig:fundteor_pca_ya}
        \end{subfigure}
       ~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
	\begin{subfigure}[b]{0.3\textwidth}
                \includegraphics[width=\textwidth]{./figs/pca_xyn.png}
	        \caption{}
                \label{fig:fundteor_pca_xya}
        \end{subfigure}

        \caption{Imagens normalizadas.}
	\fonte{Autoria própria}
	\label{fig:fundteor_pca3}
\end{figure}

Caso se deseje normalizar a imagem com relação ao tamanho pode-se dividir o valor das coordenadas $y$ pelos autovalores correspondentes \cite{GONZALEZ-2006}.


\section{Descrição} \label{sec:descricao}

Esta seção apresenta técnicas e algoritmos para realizar a descrição de imagens, tais como extração de propriedades básicas de regiões e descritores de \emph{fourier}.


\subsection{Propriedades de regiões}

Propriedades básicas de regiões, como área e excentricidade, podem ser usadas para descrever imagens. A seguir descrevemos algumas propriedades básicas de regiões, principalmente aquelas que possuem como saída um valor escalar, visto que são facilmente adicionados à um vetor descritor.

\subsubsection{Área}

A área de uma região é o número de pixeis da região \cite{MATHWORKS-HELP-2}.

\subsubsection{Área convexa}

A área convexa é dada pela área do menor polígono capaz de conter a região \cite{MATHWORKS-HELP-2}.

\subsubsection{Área Preenchida}

Área preenchida corresponde a área da região cujas cavidades foram todas preenchidas \cite{MATHWORKS-HELP-2}.

\subsubsection{Solidez}

A solidez de uma região é dada pela razão Área / Área convexa \cite{MATHWORKS-HELP-2}.

\subsubsection{Extensão}

Semelhantemente à área convexa, a extensão é dada pela razão entre a área da região (definida anteriormente) e a área do menor retângulo capaz de conter a região \cite{MATHWORKS-HELP-2}.

\subsubsection{Excentricidade}

Para a obtenção da excentricidade de uma região deve-se primeiramente obter o momento de inércia de área da região \cite{MATHWORKS-HELP-2}. O momento de inércia de área para uma região qualquer no sistema de coordenadas polares é definido pela equação \ref{eq:fundteor_mom_in}:

\begin{equation}
J_{BB} = \int_{A}^{ } \rho ^{2} dA
\label{eq:fundteor_mom_in}
\end{equation}

Onde $A$ é a área da região sobre a qual se deseja calcular o momento de inércia de área e $\rho$ é a distância do centro do sistema de coordenadas até $dA$. Uma representação da área pode ser vista na figura \ref{fig:fundteor_mom_in_fig}.

\begin{figure}[H]
	\centering
	\includegraphics[width=0.3\textwidth]{./figs/Polar_Moment_of_Inertia.png}
	\caption{Representação da área para cálculo do momento de inércia.}
	\fonte{\cite{IMAGEM-MOMENTO-INERCIA}}
	\label{fig:fundteor_mom_in_fig}
\end{figure}

A excentricidade da região é então a excentricidade da elipse que possui o mesmo momento de inércia que a área da região.
A excentricidade para uma elipse com semi-eixo maior $a$ e semi-eixo menor $b$ é dada pela equação \ref{eq:fundteor_exc}:

\begin{equation}
e = \sqrt{1 - \frac{b^2}{a^2}}
\label{eq:fundteor_exc}
\end{equation}

\subsubsection{Tamanho do eixo principal e eixo secundário}

O tamanho do eixo principal de uma região diz respeito ao tamanho do maior eixo da elipse que possui o mesmo momento de inércia que a área da região, conforme visto anteriormente na seção Excentricidade \cite{MATHWORKS-HELP-2}. Da mesma forma o tamanho do eixo secundário diz respeito ao tamanho do menor eixo da elipse que possui o mesmo momento de inércia que a área da região.

\subsubsection{Número de Euler}

O número de Euler é dado pelo total de objetos desconexos da região menos o total de cavidades da região \cite{MATHWORKS-HELP-2}.


\subsection{Descritores de \emph{fourier}}

Considere a figura \ref{fig:fundteor_fourier_desc_org}. Os pixeis com valor $1$ da imagem binária podem ser representados como sendo pares de coordenadas $(x_{0},y_{0}),(x_{1},y_{1}),(x_{2},y_{2}),...,(x_{K-1},y_{K-1})$, onde $K$ é o número de pixeis na imagem. Além disso os pixeis podem ser representados como uma sequencia $x(k) = x_{k}$ e $y(k) = y_{k}$ ou como $s(k) = \left [ x(k), y(k) \right ]$ para $k = 0,1,2,...,K-1$. Além disso pode-se tratar as coordenadas dos pixeis como números complexos: $s(k) = x(k) + j y(k)$.

Tem-se que a transformada discreta de \emph{fourier} de um sinal $s(k)$ é dado pela equação \ref{eq:fundteor_dft} \cite{GONZALEZ-2006}:

\begin{equation}
a(u) = \sum_{k=0}^{K-1} s(k) e^{-j2 \pi u k / K} ~~~~~ ,u = 0,1,2,...,K-1
\label{eq:fundteor_dft}
\end{equation}

Os coeficientes complexos $a(u)$ da transformada discreta de \emph{fourier} são chamados de descritores de \emph{fourier} \cite{GONZALEZ-2006}.

Da mesma forma que se aplicou a transformada discreta de \emph{fourier} para obter os descritores de \emph{fourier} pode-se aplicar a transformada discreta inversa de \emph{fourier} nos coeficientes complexos para obter novamente os números complexos representando as coordenadas dos pixeis (equação \ref{eq:fundteor_idft}).

\begin{equation}
s(k) = \frac{1}{K} \sum_{u=0}^{K-1} a(u) e^{j2 \pi u k / K} ~~~~~ ,k = 0,1,2,...,K-1
\label{eq:fundteor_idft}
\end{equation}

Suponha agora que ao invés de utilizar todos os descritores de \emph{fourier} utiliza-se apenas os $P$ primeiros descritores para reconstituir $s(k)$. Tem-se portanto uma aproximação para $s(k)$ dada por $\hat{s}(k)$ na equação \ref{eq:fundteor_idft_a}.

\begin{equation}
\hat{s}(k) = \frac{1}{P} \sum_{u=0}^{P-1} a(u) e^{j2 \pi u k / P} ~~~~~ ,k = 0,1,2,...,K-1
\label{eq:fundteor_idft_a}
\end{equation}

Quando os $P$ coeficientes de menor frequência são escolhidos para reconstituir a imagem tem-se uma imagem aproximada da imagem original porém que mantém as principais características. Pode-se ver esse comportamento nas imagens da figura \ref{fig:fundteor_fourier_desc}. A imagem da figura \ref{fig:fundteor_fourier_desc_1} foi forma utilizando todos os 19410 coeficientes da imagem original, a imagem \ref{fig:fundteor_fourier_desc_2} foi formada com 9705 coeficientes, e assim por diante, até apenas 2 coeficientes na figura \ref{fig:fundteor_fourier_desc_8192}.

\begin{figure}[H]
        \centering
	\begin{subfigure}[b]{0.29\textwidth}
                \includegraphics[width=\textwidth]{./figs/Ai.png}
	        \caption{Imagem original}
                \label{fig:fundteor_fourier_desc_org}
        \end{subfigure}
       ~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
	\begin{subfigure}[b]{0.29\textwidth}
                \includegraphics[width=\textwidth]{./figs/A1.png}
	        \caption{19410 coeficientes}
                \label{fig:fundteor_fourier_desc_1}
        \end{subfigure}
	~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
	\begin{subfigure}[b]{0.29\textwidth}
                \includegraphics[width=\textwidth]{./figs/A2.png}
	        \caption{9705 coeficientes}
                \label{fig:fundteor_fourier_desc_2}
        \end{subfigure}

	\begin{subfigure}[b]{0.29\textwidth}
                \includegraphics[width=\textwidth]{./figs/A4.png}
	        \caption{4852 coeficientes}
                \label{fig:fundteor_fourier_desc_4}
        \end{subfigure}
	~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
	\begin{subfigure}[b]{0.29\textwidth}
                \includegraphics[width=\textwidth]{./figs/A8.png}
	        \caption{2426 coeficientes}
                \label{fig:fundteor_fourier_desc_8}
        \end{subfigure}
	~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
	\begin{subfigure}[b]{0.29\textwidth}
                \includegraphics[width=\textwidth]{./figs/A16.png}
	        \caption{1213 coeficientes}
                \label{fig:fundteor_fourier_desc_16}
        \end{subfigure}

	\begin{subfigure}[b]{0.29\textwidth}
                \includegraphics[width=\textwidth]{./figs/A32.png}
	        \caption{606 coeficientes}
                \label{fig:fundteor_fourier_desc_32}
        \end{subfigure}
	~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
	\begin{subfigure}[b]{0.29\textwidth}
                \includegraphics[width=\textwidth]{./figs/A64.png}
	        \caption{303 coeficientes}
                \label{fig:fundteor_fourier_desc_64}
        \end{subfigure}
	~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
	\begin{subfigure}[b]{0.29\textwidth}
                \includegraphics[width=\textwidth]{./figs/A128.png}
	        \caption{151 coeficientes}
                \label{fig:fundteor_fourier_desc_128}
        \end{subfigure}

	\begin{subfigure}[b]{0.29\textwidth}
                \includegraphics[width=\textwidth]{./figs/A256.png}
	        \caption{75 coeficientes}
                \label{fig:fundteor_fourier_desc_256}
        \end{subfigure}
	~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
	\begin{subfigure}[b]{0.29\textwidth}
                \includegraphics[width=\textwidth]{./figs/A512.png}
	        \caption{37 coeficientes}
                \label{fig:fundteor_fourier_desc_512}
        \end{subfigure}
	~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
	\begin{subfigure}[b]{0.29\textwidth}
                \includegraphics[width=\textwidth]{./figs/A1024.png}
	        \caption{18 coeficientes}
                \label{fig:fundteor_fourier_desc_1024}
        \end{subfigure}

	\begin{subfigure}[b]{0.29\textwidth}
                \includegraphics[width=\textwidth]{./figs/A2048.png}
	        \caption{9 coeficientes}
                \label{fig:fundteor_fourier_desc_2048}
        \end{subfigure}
	~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
	\begin{subfigure}[b]{0.29\textwidth}
                \includegraphics[width=\textwidth]{./figs/A4096.png}
	        \caption{4 coeficientes}
                \label{fig:fundteor_fourier_desc_4096}
        \end{subfigure}
	~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
	\begin{subfigure}[b]{0.29\textwidth}
                \includegraphics[width=\textwidth]{./figs/A8192.png}
	        \caption{2 coeficientes}
                \label{fig:fundteor_fourier_desc_8192}
        \end{subfigure}

        \caption{Imagem original e imagens reconstituídas utilizando $n$ descritores de \emph{fourier}.}
	\fonte{Autoria própria}
	\label{fig:fundteor_fourier_desc}
\end{figure}



\section{Classificação} \label{sec:classificacao}

Esta seção apresenta uma visão geral de reconhecimento de padrões utilizando redes neurais.


\subsection{Redes neurais}

Redes neurais são elementos não lineares (chamados neurônios) interconectados da mesma maneira que se acredita que os neurônios estão conectados no cérebro. Usam-se essas redes para tomadas de decisão após seus coeficientes terem sido ajustados por meio de apresentações sucessivas de conjuntos de dados de treinamento \cite{GONZALEZ-2006}.

Na forma mais simples no entanto a rede é um elemento linear e é composta por um único neurônio, também chamado \emph{perceptron}. Esse neurônio então aprende uma função linear para separar dois conjuntos de dados de treinamento linearmente separáveis. A figura \ref{fig:fundteor_nn_perceptron_model} apresenta o modelo básico para um \emph{perceptron}. A resposta desse \emph{perceptron} é baseada na soma ponderada das entradas, dada pela equação \ref{eq:fundteor_nn_perceptron}.

\begin{equation}
d(x) = \sum_{i=1}^{n} (\omega _{i} x_{i}) + \omega _{n+1}
\label{eq:fundteor_nn_perceptron}
\end{equation}

Os coeficientes $w_{i}, i=1,2,...,n,n+1$, são chamados de pesos e modificam a soma antes que os valores de entrada passem pelo elemento de ativação, também chamado de função de ativação. Os pesos podem ser comparados às sinapses que ocorrem no cérebro humano. No caso particular da figura \ref{fig:fundteor_nn_perceptron_model} a saída do \emph{perceptron} será $+1$ caso a entrada pertença a classe $\omega_{1}$ e $-1$ caso a entrada pertença a classe $\omega_{2}$.

\begin{figure}[H]
	\centering
	\includegraphics[width=1\textwidth]{./figs/perceptron_model.png}
	\caption{Modelo de \emph{perceptron}.}
	\fonte{\cite{GONZALEZ-2006}}
	\label{fig:fundteor_nn_perceptron_model}
\end{figure}

Esse tipo de abordagem formada por um único \emph{perceptron} não é capaz de separar mais do que duas classes e também não é capaz de separar classes que não são linearmente separáveis. Isso se dá devido ao fato de que a equação \ref{eq:fundteor_nn_perceptron} quando expandida define um hiperplano em um espaço $n$-dimensional.

Utilizam-se portanto para problemas mais complexos redes de neurônios, também chamada de \emph{multi-layer perceptron} ou \emph{multi-layer feedforward network}. Cada neurônio é formado por uma estrutura do mesmo tipo da estrutura do \emph{perceptron}, com a diferença de a função de ativação ser geralmente uma função sigmoide ao invés de um simples limiar. A função sigmoide pode ser vista na equação \ref{}  e na figura \ref{}. A saída dos neurônios estão interconectadas com as entradas de outros neurônio. Essa estrutura pode ser vista na figura \ref{fig:fundteor_nn_multilayer_perceptron_model}.

\begin{equation}
h_{j}(I_{j}) = \frac {1}{1+e^{-(I_{j} + \theta_{j})/\theta_{O}}}
\label{eq:fundteor_nn_perceptron_sigmoide}
\end{equation}

\begin{figure}[H]
	\centering
	\includegraphics[width=1\textwidth]{./figs/multilayer_perceptron_sigmoide.png}
	\caption{Gráfico da função de ativação sigmoide.}
	\fonte{\cite{GONZALEZ-2006}}
	\label{fig:fundteor_nn_multilayer_perceptron_sigmoide}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width=1\textwidth]{./figs/multilayer_perceptron_model.png}
	\caption{Modelo de \emph{multi-layer feedforward network}.}
	\fonte{\cite{GONZALEZ-2006}}
	\label{fig:fundteor_nn_multilayer_perceptron_model}
\end{figure}

Nesse tipo de rede a primeira camada, $A$, possui o mesmo número de neurônios que a dimensão do vetor descritor da entrada, $N_{A} = n$. Semelhantemente o número de neurônios da camada de saída, $Q$, é igual ao número de classes que a rede deve reconhecer, $N_{Q} = {W}$. A rede reconhece uma entrada como sendo parte de uma classe quando a saída da classe é um e as demais saídas são zero.

Pode-se demonstrar que redes desse tipo são capazes de separar regiões convexas no espaço $n$-dimensional de entradas utilizando duas camadas de neurônios. São também capazes de separar classes em regiões arbitrárias utilizando três camadas de neurônios  \cite{GONZALEZ-2006}. A complexidade das regiões separadas por uma rede de três camadas se dá pelo número de neurônios em cada camada. Isso está resumido na figura \ref{fig:fundteor_nn_multilayer_perceptron_decision}.

\begin{figure}[H]
	\centering
	\includegraphics[width=1\textwidth]{./figs/multilayer_perceptron_decision.png}
	\caption{Estruturas de redes neurais e sua respectiva capacidade de decisão.}
	\fonte{\cite{GONZALEZ-2006}}
	\label{fig:fundteor_nn_multilayer_perceptron_decision}
\end{figure}


\subsubsection{Treinamento de \emph{perceptrons}}

O treinamento de \emph{perceptrons} consiste em determinar os valores adequados de $\omega_{i}$ para que a soma ponderada das entradas forme a saída adequada para a função de ativação. Existem diversos métodos de treinamento para determinar os valores de $\omega_{i}$ para um único perceptron. Apresenta-se a seguir o método denominado \emph{delta rule} ou \emph{least-mean-square}.

A principal característica do método \emph{delta rule} é que ele minimiza o erro entre a saída desejada e a saída real do \emph{perceptron} em cada passo de treinamento. Considere a função da equação \ref{eq:fundteor_nn_perceptron_error}. 

\begin{equation}
J(w) = \frac{1}{2} (r - w^{T}y)^2
\label{eq:fundteor_nn_perceptron_error}
\end{equation}

$J(w)$ representa o erro quadrático para um dado conjunto de pesos $w$. O erro é calculado como sendo a diferença entre a saída desejada do \emph{perceptron} $r$ e a saída real dada pelo produto do vetor de pesos transposto $w^{T}$ com o valor de entrada do conjunto de treinamento $y$.

O objetivo do treinamento pelo método \emph{delta rule} é minimizar $J(w)$ ajustando os valores dos pesos $w$.

Se $w(k)$ representa o vetor de pesos no passo de treinamento $k$, então pode-se calcular $w(k+1)$ de forma a reduzir o valor de $J(w)$ utilizando a equação \ref{eq:fundteor_nn_perceptron_error_desc} \cite{GONZALEZ-2006}.

\begin{equation}
w(k+1) = w(k) - \alpha \left [ \frac{\partial J(w)}{\partial w} \right ] _{w=w(k)}
\label{eq:fundteor_nn_perceptron_error_desc}
\end{equation}

Onde $\alpha > 0$ é uma constante escolhida de acordo com o grau de correção que se deseja a cada passo. Da equação \ref{eq:fundteor_nn_perceptron_error} tem se que:

\begin{equation}
\frac{\partial J(w)}{\partial w} = -(r - w^{T} y)y
\label{eq:fundteor_nn_perceptron_error_der}
\end{equation}

Substituindo a equação \ref{eq:fundteor_nn_perceptron_error_der} na equação \ref{eq:fundteor_nn_perceptron_error_desc} resulta na equação \ref{eq:fundteor_nn_perceptron_error_desc_2} que pode ser utilizada para o cálculo dos coeficientes $w(k+1)$ dados os coeficientes $w(k)$, a saída desejada $r$ e o valor de entrada do conjunto de treinamento $y$. 

\begin{equation}
w(k+1) = w(k) + \alpha \left [ r(k) - w^{T} (k) y(k) \right ] y(k)
\label{eq:fundteor_nn_perceptron_error_desc_2}
\end{equation}

Pode-se demonstrar que utilizando esse método para calcular os coeficientes, tem-se a redução do erro do $perceptron$ em um fator de $\alpha y(k)^{T} y(k)$ a cada ciclo de treinamento \cite{GONZALEZ-2006}.

\subsubsection{Treinamento de \emph{multi-layer perceptrons}}

O treinamento de redes multicamadas pode ser efetuado de maneira semelhante ao treinamento de um único \emph{perceptron}. Considere a equação \ref{eq:fundteor_nn_perceptron_error_multi}. O erro quadrático $E_{Q}$ obtido na camada de saída é dado pela soma dos erros quadráticos em todos os \emph{perceptrons} da camada de saída (\emph{perceptrons} de $1$ a $N_{Q}$). O erro em cada \emph{perceptron} é dado pela diferença entre a saída desejada $r_{q}$, no perceptron $q$, e a saída obtida $O_{q}$.

\begin{equation}
E_{Q} = \frac{1}{2} \sum_{q=1}^{N_{Q}} (r_{q} - O_{q})^{2}
\label{eq:fundteor_nn_perceptron_error_multi}
\end{equation}

Novamente deseja-se minimizar o erro $E_{Q}$ em cada passo de treinamento. Não será mostrado aqui o processo completo para determinação dos coeficientes minimizando a equação \ref{eq:fundteor_nn_perceptron_error_multi}. Mas o desenvolvimento completo pode ser encontrado em \cite{GONZALEZ-2006}. 

Os coeficientes $w(k+1)$ para um \emph{perceptron} na camada $J$, que é precedida por uma camada $K$, podem ser determinados pela equação \ref{eq:fundteor_nn_perceptron_error_multi_desc_2}.

\begin{equation}
w(k+1) = w(k) + \alpha \delta _{j}O_{k}
\label{eq:fundteor_nn_perceptron_error_multi_desc_2}
\end{equation}

Onde $O_{k}$ é a saída da camada $K$  e $\alpha > 0$ é uma constante escolhida de acordo com o grau de correção que se deseja a cada passo de treinamento. Se $J$ for a camada de saída da rede, ou seja, $J=Q$, então $\delta_{j}$ será dado pela equação \ref{eq:fundteor_nn_perceptron_error_multi_desc_3}.

\begin{equation}
\delta_{j} = (r_{j} - O_{j})h'_{j}(I_{j})
\label{eq:fundteor_nn_perceptron_error_multi_desc_3}
\end{equation}

Caso $J$ seja um perceptron em uma camada interna, e $P$ a camada imediatamente posterior a $J$, $\delta_{j}$ será dado pela equação \ref{eq:fundteor_nn_perceptron_error_multi_desc_4}.

\begin{equation}
\delta_{j} = h'_{j}(I_{j}) \sum_{p=1}^{N_{P}} \delta_{p} \omega_{jp}
\label{eq:fundteor_nn_perceptron_error_multi_desc_4}
\end{equation}

Ou seja, o calculo de $\delta$ para um \emph{perceptron} da camada $J$ depende dos pesos da camada seguinte para o \emph{perceptron} $j$, $\omega_{jp}$,  e do valor de $\delta$ da camada seguinte, $\delta_{p}$. $h'_{j}$ é a derivada da função de ativação $h_{j}$ e $I_{j}$ é a entrada da função de ativação. 

Caso a função de ativação escolhida seja a função sigmoide, a derivada $h'_{j}$ é dada pela equação \ref{eq:fundteor_nn_perceptron_error_multi_desc_5}.

\begin{equation}
h'(I_{j}) = 
\label{eq:fundteor_nn_perceptron_error_multi_desc_5}
\end{equation}




A entrada da função de ativação é a soma ponderada das saídas da camada $K$, $o_{k}$, utilizando os pesos atuais do perceptron que se deseja atualizar, $\omega_{jk}$, como mostrado na equação \ref{eq:fundteor_nn_perceptron_error_multi_desc_5}.

\begin{equation}
I_{j} = \sum_{k=1}^{N_{K}} o_{k} \omega_{jk}
\label{eq:fundteor_nn_perceptron_error_multi_desc_5}
\end{equation}

Tanto na equação \ref{eq:fundteor_nn_perceptron_error_multi_desc_3} quanto na equação \ref{eq:fundteor_nn_perceptron_error_multi_desc_4} 

%$w(k)$ - vetor de pesos para época k
%y(k) uma amostra que pertence a uma classe
%c - constante de aprendizagem
%
%
%existem diversos back propagations
%dar uma visao geral do delta rule











\begin{equation}\label{W-matrix}
    W^{inicial}=\left(
       \begin{array}{ccccc}
         0,00 & -0,40 & -0,25 & 0,00 & 0,30 \\
         0,36 & 0,00 & 0,00 & 0,00 & w0,00 \\
         0,45 & 0,00 & 0,00 & 0,00 & 0,00 \\
         -0,90 & 0,00 & 0,00 & 0,00 & 0,00 \\
         0,00 & 0,60 & 0,00 & 0,30 & 0,00 \\
       \end{array}
     \right)
\end{equation}

\begin{enumerate}
\item SE a intensidade do sensor frontal (FS) for maior que um limiar médio ENTÃO $W_{lim}$ aplicado para computar o relacionamento $w_3$ é o valor máximo de $WF_{max}$;
\item SE a intensidade do sensor frontal (FS) for menor que um limiar mínimo ENTÃO $W_{lim}$ aplicado para computar o relacionamento $w_3$ é o valor mínimo de $WF_{min}$;
\item SE a intensidade do sensor direito (RS) for maior que um limiar médio ENTÃO $W_{lim}$ aplicado para computar o relacionamento $w_1$ é o valor máximo de $WR_{max}$;
\item SE a intensidade do sensor direito (RS) for menor que um limiar mínimo ENTÃO $W_{lim}$ aplicado para computar o relacionamento $w_1$ é o valor mínimo de $WR_{min}$;
\item SE a intensidade do sensor esquerdo (LS) for maior que um limiar médio ENTÃO $W_{lim}$ aplicado para computar o relacionamento $w_5$ é o valor máximo de $WL_{max}$;
\item SE a intensidade do sensor direito (LS) for menor que um limiar mínimo ENTÃO $W_{lim}$ aplicado para computar o relacionamento $w_5$ é o valor mínimo de $WL_{min}$.
\end{enumerate}

\begin{table}[htb!]
	\centering
	\caption[Relações causais do controlador do robô]{Relações causais do controlador do robô.}		
	\begin{tabular}[H]{ l l l l }
	  \hline
	  Relação causal & Descrição & Efeito & Intensidade \\
	  \hline
	  $w_1$ & Sensor direito (RS) influencia a saída esquerda (LO) & Positivo & Forte \\
	  $w_2$ & Sensor frontal (FS) influencia a saída esquerda (LO) & Positivo & Médio \\
	  $w_3$ & Sensor frontal (FS) influencia a saída frontal (FO) & Positivo & Forte \\
	  $w_4$ & Sensor frontal (FS) influencia a saída direita (RO) & Positivo & Médio \\
	  $w_5$ & Sensor esquerdo (LS) influencia a saída direita (RO) & Positivo & Forte \\
	  $w_6$ & Saída esquerda (LO) influencia a saída direita (RO) & Negativo & Fraco \\
	  $w_7$ & Saída direita (RO) influencia a saída esquerda (LO) & Negativo & Fraco \\
	  $w_8$ & Sensor direito (RS) influencia a saída direita (RO) & Negativo & Fraco \\
	  $w_9$ & Sensor esquerdo (LS) influencia a saída esquerda (LO) & Negativo & Fraco \\
	  \hline  	
	\end{tabular}
	\fonte{\cite{MENDONCA}}
	\label{tab:causal-relations}
\end{table}


